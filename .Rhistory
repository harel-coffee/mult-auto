df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0, 0))
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0, 0)) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.25, 0)) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0)) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0), legend.box.margin = 1) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0), legend.box = 'horizontal') +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0), legend.box = 'vertical') +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0), legend.direction = 'horizontal') +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0), legend.direction = 'horizontal', legend.background = element_blank()) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0), legend.direction = 'horizontal', legend.box.background = element_rect(colour = "black")) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.35, 0.1),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.1),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("e", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
p <- ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
ggsave('images/fish_plot.pdf', p, width=16, height=16, units=16)
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
p <- ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
ggsave('images/fish_plot.pdf', p, width=16, height=16, units='cm')
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
p <- ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
ggsave('images/fish_plot.pdf', p, width=16, height=15, units='cm')
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
p <- ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
ggsave('images/fish_plot.pdf', p, width=16, height=14, units='cm')
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
p <- ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
xlab('FISH') + ylab('Count') +
scale_fill_grey('BRFT_G2') + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
ggsave('images/fish_plot.pdf', p, width=16, height=14, units='cm')
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
p <- ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
xlab('FISH') + ylab('Count') +
scale_fill_grey('BRFT_G2', labels = c("High Risk", "Low Risk", "NA")) + scale_colour_grey('BRFT_G2') +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
ggsave('images/fish_plot.pdf', p, width=16, height=14, units='cm')
p
df <- read.csv('data/clinical.tsv', sep='\t', stringsAsFactors = F)
df <- df[c('response_best_response_first_line', 'X13q14', 'X13q34', 'X17p13', 'X1q21', 'X11p15', 'X15q15', 'X19q13', 'X20q13', 'X21q22', 'X3q21', 'X5q31', 'X7q22',
'X9q33', 't_11_14_ccnd1', 't_12_14_ccnd2', 't_14_16_maf', 't_14_20_mafb', 't_4_14_whsc1', 't_6_14_ccnd3', 't_8_14_mafa', 't_8_14_myc')]
require(ggplot2)
resp = df$response_best_response_first_line
df = stack(df, select=-response_best_response_first_line)
df$resp <- resp
df[is.na(df)] <- 'NA'
df[df==''] <- 'NA'
df[df=='Detected'] <- 1
df[df=='Not Detected'] <- 0
df$ind <- gsub("X", "", df$ind)
p <- ggplot(df) +
geom_bar(aes(values, fill=resp, colour=resp), alpha=.6) +
xlab('FISH') + ylab('Count') +
scale_fill_grey('BRFT_G2', labels = c("High Risk", "Low Risk", "NA")) +
scale_colour_grey('BRFT_G2', labels = c("High Risk", "Low Risk", "NA")) +
theme(legend.position = c(0.55, 0.06),
legend.direction = 'horizontal',
legend.box.background = element_rect(colour = "black"),
legend.background = element_blank()) +
facet_wrap(ind  ~ .)
ggsave('images/fish_plot.pdf', p, width=16, height=14, units='cm')
p
##
clinical_mic <- read.csv('output/correlation_clinical_x_m2dp.csv', sep=',', header=T)
clinical_mic$resp <- 'M2DP (MIC)'
clinical_pva <- read.csv('output/correlation_clinical_x_brft.csv', sep=',', header=T)
clinical_pva$metric = 1 - clinical_pva$metric
clinical_pva$resp <- 'BRFT_G2 (1 - pvalue)'
clinical <- rbind(clinical_mic, clinical_pva)
clinical[is.na(clinical)] = 0
clinical$feature = sapply(clinical$feature, function(x) toupper(substr(x, 0, 25)))
##
fish_mic <- read.csv('output/correlation_fish_x_m2dp.csv', sep=',', header=T)
fish_mic$resp <- 'M2DP (MIC)'
fish_pva <- read.csv('output/correlation_fish_x_brft.csv', sep=',', header=T)
fish_pva$metric = 1 - fish_pva$metric
fish_pva$resp <- 'BRFT_G2 (1 - pvalue)'
fish <- rbind(fish_mic, fish_pva)
fish[is.na(fish)] = 0
fish$feature = sapply(fish$feature, function(x) toupper(substr(x, 0, 25)))
##
genexp_mic <- read.csv('output/correlation_geneexp_x_m2dp.csv', sep=',', header=T)
genexp_mic$resp <- 'M2DP (MIC)'
genexp_pva <- read.csv('output/correlation_geneexp_x_brft.csv', sep=',', header=T)
genexp_pva$metric = 1 - genexp_pva$metric
genexp_pva$resp <- 'BRFT_G2 (1 - pvalue)'
genexp <- rbind(genexp_mic, genexp_pva)
##
require(ggplot2)
p <- ggplot(clinical) +
geom_bar(stat='identity', aes(feature, metric), colour='gray28', alpha=.6) +
facet_grid(. ~ resp) +
theme(text=element_text(size=11, family='serif')) +
xlab('Feature') + ylab('Correlation Metric Value') +
coord_flip()
ggsave('images/correlation_clinical.pdf', p, width=16, height=20, units='cm')
p <- ggplot(fish) +
geom_bar(stat='identity', aes(feature, metric), colour='gray28', alpha=.6) +
facet_grid(. ~ resp) +
theme(text=element_text(size=11, family='serif')) +
xlab('Feature') + ylab('Correlation Metric Value') +
coord_flip()
ggsave('images/correlation_fish.pdf', p, width=16, height=14, units='cm')
##
p <- ggplot(genexp) +
geom_histogram(aes(metric), colour='gray28', alpha=.6) +
facet_grid(. ~ resp, scales = "free_x") +
theme(text=element_text(size=11, family='serif')) +
xlab('Feature') + ylab('Correlation Metric Value')
ggsave('images/correlation_genexp.pdf', p, width=16, height=8, units='cm')
##
clinical_mic <- read.csv('output/correlation_clinical_x_m2dp.csv', sep=',', header=T)
clinical_mic$resp <- 'M2DP (MIC)'
clinical_pva <- read.csv('output/correlation_clinical_x_brft.csv', sep=',', header=T)
clinical_pva$metric = 1 - clinical_pva$metric
clinical_pva$resp <- 'BRFT_G2 (1 - pvalue)'
clinical <- rbind(clinical_mic, clinical_pva)
clinical[is.na(clinical)] = 0
clinical$feature = sapply(clinical$feature, function(x) toupper(substr(x, 0, 25)))
##
fish_mic <- read.csv('output/correlation_fish_x_m2dp.csv', sep=',', header=T)
fish_mic$resp <- 'M2DP (MIC)'
fish_pva <- read.csv('output/correlation_fish_x_brft.csv', sep=',', header=T)
fish_pva$metric = 1 - fish_pva$metric
fish_pva$resp <- 'BRFT_G2 (1 - pvalue)'
fish <- rbind(fish_mic, fish_pva)
fish[is.na(fish)] = 0
fish$feature = sapply(fish$feature, function(x) toupper(substr(x, 0, 25)))
##
genexp_mic <- read.csv('output/correlation_geneexp_x_m2dp.csv', sep=',', header=T)
genexp_mic$resp <- 'M2DP (MIC)'
genexp_pva <- read.csv('output/correlation_geneexp_x_brft.csv', sep=',', header=T)
genexp_pva$metric = 1 - genexp_pva$metric
genexp_pva$resp <- 'BRFT_G2 (1 - pvalue)'
genexp <- rbind(genexp_mic, genexp_pva)
##
require(ggplot2)
p <- ggplot(clinical) +
geom_bar(stat='identity', aes(feature, metric), colour='gray28', alpha=.6) +
facet_grid(. ~ resp) +
theme(text=element_text(size=11, family='serif')) +
xlab('Feature') + ylab('Correlation Metric Value') +
coord_flip()
ggsave('images/correlation_clinical.pdf', p, width=16, height=20, units='cm')
p <- ggplot(fish) +
geom_bar(stat='identity', aes(feature, metric), colour='gray28', alpha=.6) +
facet_grid(. ~ resp) +
theme(text=element_text(size=11, family='serif')) +
xlab('Feature') + ylab('Correlation Metric Value') +
coord_flip()
ggsave('images/correlation_fish.pdf', p, width=16, height=14, units='cm')
##
p <- ggplot(genexp) +
geom_histogram(aes(metric), colour='gray28', alpha=.6) +
facet_grid(. ~ resp, scales = "free_x") +
theme(text=element_text(size=11, family='serif')) +
xlab('Correlation Metric Value') + ylab('Count')
ggsave('images/correlation_genexp.pdf', p, width=16, height=8, units='cm')
